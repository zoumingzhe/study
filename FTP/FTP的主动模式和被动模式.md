# FTP主动模式（PORT）
## 主动模式工作过程
1. 客户端以随机非特权端口（N > 1024），对服务端命令端口（21端口）发送用户名和密码登录；

2. 登录成功后客户端在（N+1）端口监听，并且通过（N+1）端口发送PORT命令给FTP服务器；

3. 服务端会主动以20端口连接到客户端的（N+1）端口，发送数据。

## 主动模式优点
服务端只需要开放21端口，配置简单，利于服务器安全管理。

## 主动模式缺点
如果客户端开启了防火墙，或客户端处于内网（NAT网关之后），那么服务端对客户端的连接可能会失败。

# FTP被动模式（PASV）
## 被动模式工作过程
1. 客户端以随机非特权端口（N > 1024），对服务端命令端口（21端口）发送用户名和密码登录；

2. 登录成功后发送PASV命令到服务端，服务端开放一个随机非特权端口（N > 1024）为被动端口，并将端口号返回给客户端；

3. 客户端主动连接服务端开放的被动端口。

## 被动模式优点
对客户端网络环境没有要求。

## 被动模式缺点
服务端需要开放随机高位端口以便客户端连接，配置管理稍显复杂，不利于安全，因此大多数FTP服务软件都可以手动配置被动端口的范围。

# 参考
1.[重温FTP的主动模式和被动模式](https://my.oschina.net/binny/blog/17469)

2.[FTP服务的主动模式和被动模式](https://www.cnblogs.com/huangxm/p/6274645.html)
